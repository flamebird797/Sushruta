<div class="timeline-wrapper">
  <h3>🗂 Chart Timeline</h3>

  <ul class="timeline-list">
    <li *ngFor="let chart of chartHistory" (click)="selectChart(chart)" class="timeline-item">
      <span class="timeline-icon">📅</span>
      <span class="timeline-content">
        <strong>{{ chart.chartName }}</strong> — <span class="timestamp">{{ chart.timestamp | date: 'short' }}</span>
      </span>
    </li>
  </ul>

  <div *ngIf="selectedChart" class="chart-detail">
    <h4>📝 {{ selectedChart.chartName }}</h4>
    <p><strong>Date:</strong> {{ selectedChart.timestamp | date: 'fullDate' }}</p>

    <div class="mode-selector">
  <label for="mode">Annotation Mode:</label>
  <select id="mode" [(ngModel)]="activeMode">
    <option value="pain">Pain</option>
    <option value="scar">Scar</option>
    <option value="bruise">Bruise</option>
    <option value="burn">Burn</option>
    <option value="discoloration">Discoloration</option>
  </select>
</div>

    <app-body-map
  [regionData]="selectedChart.regions"
  [readonly]="true"
  [activeMode]="activeMode"
  style="width: 100%; height: 500px; border: 1px solid #ccc; margin-bottom: 20px; border-radius: 10px;"
></app-body-map>
    <div class="region-table-section">
      <h5>📋 Full Region Breakdown:</h5>
      <table class="notes-table">
        <thead>
          <tr>
            <th>Region</th>
            <th>{{ activeMode | titlecase }} Level</th>
            <th>Note</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let entry of regionTable(selectedChart)">
            <tr *ngIf="entry.level > 0">
              <td>{{ entry.region.replaceAll('_', ' ') }}</td>
              <td>{{ entry.level }}</td>
              <td>{{ entry.note || '-' }}</td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>
</div>